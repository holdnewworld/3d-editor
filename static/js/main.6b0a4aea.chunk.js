(this["webpackJsonpfront-end"]=this["webpackJsonpfront-end"]||[]).push([[0],{217:function(e,t,a){e.exports=a(225)},223:function(e,t,a){},225:function(e,t,a){"use strict";a.r(t);var n=a(16),r=a.n(n),c=a(212),s=a.n(c),l=a(129);function o(e){var t=e.setUser,a=e.setToken,c=Object(n.useState)({login:!0,ok:!0}),s=Object(l.a)(c,2),o=s[0],i=s[1];return r.a.createElement("form",{onSubmit:function(e){var n=new FormData(e.target),r="https://ancient-journey-05279.herokuapp.com/users/".concat(o.login?"login":"register");fetch(r,{method:"POST",body:n}).then((function(e){return e.json()})).then((function(e){t(e.user),a(e.token)})).catch((function(e){return i({login:o.login,ok:!1})})),e.preventDefault()},className:"bg-transparent text-white rounded shadow-lg"},r.a.createElement("h2",{className:"text-center"},o.login?"Login":"Register"),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",null,"Username"),r.a.createElement("input",{type:"text",name:"username",className:"form-control bg-transparent text-white",required:!0,pattern:"[^\\s]+",placeholder:"demo"})),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",null,"Password"),r.a.createElement("input",{type:"password",name:"password",className:"form-control bg-transparent text-white",required:!0,minLength:"4",placeholder:"demo"})),!o.ok&&r.a.createElement("p",{className:"text-sm-center text-danger"},o.login?"Incorrect Username or Password":"Username existed"),r.a.createElement("button",{type:"submit",className:"btn btn-light btn-block"},o.login?"Login":"Register"),r.a.createElement("hr",null),r.a.createElement("button",{onClick:function(){i({login:!o.login,ok:!0})},type:"button",className:"btn btn-link text-info"},o.login?"Register":"Login"))}function i(e){var t=e.user,a=e.setUser,n=e.setToken;return r.a.createElement("nav",{className:"fixed-top navbar navbar-expand-lg navbar-dark bg-transparent"},r.a.createElement("a",{className:"navbar-brand",href:"https://github.com/tracy2811/3d-editor/"},r.a.createElement("img",{src:"./GitHub-Mark-Light-32px.png",width:"30",height:"30",className:"d-inline-block align-top",alt:""})," 3D EDITOR"),t&&r.a.createElement("button",{className:"ml-auto btn btn-dark",onClick:function(){a(null),n("")}},t.username," ",r.a.createElement("img",{src:"./logout.svg",width:"20",height:"20",className:"d-inline-block align-top",alt:""})))}var m=a(201),u=a(213),p=a(214),d=a(215),h=a(216),b=a(75),f=a(200);a(224);function g(e,t,a){if(e&&!t.hasMesh(e)){var n=new CustomEvent("meshSelected",{detail:e});a.dispatchEvent(n),t.removeAllMeshes(),t.addMesh(e,b.a.Green())}else{var r=new Event("meshUnSelected");a.dispatchEvent(r),t.removeAllMeshes()}}var E=function(e){Object(h.a)(a,e);var t=Object(d.a)(a);function a(e){var r;return Object(u.a)(this,a),(r=t.call(this,e)).canvasRef=Object(n.createRef)(),r.xMoveRef=Object(n.createRef)(),r.yMoveRef=Object(n.createRef)(),r.zMoveRef=Object(n.createRef)(),r.xRotateRef=Object(n.createRef)(),r.yRotateRef=Object(n.createRef)(),r.zRotateRef=Object(n.createRef)(),r.aRotateRef=Object(n.createRef)(),r.xScaleRef=Object(n.createRef)(),r.yScaleRef=Object(n.createRef)(),r.zScaleRef=Object(n.createRef)(),r.colorRef=Object(n.createRef)(),r.alphaRef=Object(n.createRef)(),r.state={mesh:null,uploaded:!1,scene:null,highlight:null},r}return Object(p.a)(a,[{key:"componentDidMount",value:function(){var e=this,t=new b.c(this.canvasRef.current,!0,{stencil:!0}),a=this.canvasRef.current;a.addEventListener("meshSelected",(function(t){return e.setState(Object(m.a)({},e.state,{},{mesh:t.detail}))})),a.addEventListener("meshUnSelected",(function(){return e.setState(Object(m.a)({},e.state,{},{mesh:null}))})),a.addEventListener("sceneLoaded",(function(t){return e.setState({mesh:null,uploaded:!0,scene:t.detail.scene,highlight:t.detail.highlight})}));var n=function(e,n){var r=new b.e("hl1",n),c=new CustomEvent("sceneLoaded",{detail:{scene:n,highlight:r}});a.dispatchEvent(c),n.createDefaultCameraOrLight(!0,!0,!0),n.activeCamera.alpha+=Math.PI,n.clearColor=new b.b(0,0,0,.7),n.onPointerObservable.add((function(e){switch(e.type){case b.f.POINTERDOWN:g(e.pickInfo.pickedMesh,r,a);break;case b.f.POINTERUP:case b.f.POINTERTAP:case b.f.POINTERDOUBLETAP:}})),t.runRenderLoop((function(){return n.render()}))},r=new b.d(t,null,n,null,null,(function(){return b.i.ClearLogCache()}),null,null);if(r.monitorElementForDragNDrop(this.canvasRef.current),a.addEventListener("change",(function(e){r.loadFiles(e)}),!1),this.props.modelEditing){var c=this.props.modelEditing.filename,s=this.props.token;fetch("https://ancient-journey-05279.herokuapp.com/models/".concat(c),{headers:{Authorization:"bearer ".concat(s)}}).then((function(e){return e.blob()})).then((function(e){var a=(window.webkitURL||window.URL).createObjectURL(e);b.g.Load("",a,t,(function(e){n(0,e),window.URL.revokeObjectURL(a)}),void 0,void 0,".glb")}))}window.addEventListener("resize",(function(){return t.resize()}))}},{key:"render",value:function(){var e=function(e,t,a){var n=this.props.setEditing,r=this.props.setModelEditing,c=this.props.token;fetch(e,{method:t,headers:{Authorization:"bearer ".concat(c)},body:a}).then((function(e){e.ok&&(n(!1),r(null))}))}.bind(this),t=function(){var e=this.state.mesh,t=+this.xMoveRef.current.value,a=+this.yMoveRef.current.value,n=+this.zMoveRef.current.value;e&&(e.position=new b.j(t,a,n))}.bind(this),a=function(){var e=this.state.mesh,t=+this.xScaleRef.current.value,a=+this.yScaleRef.current.value,n=+this.zScaleRef.current.value;e&&(e.scaling=new b.j(t,a,n))}.bind(this),n=function(){var e=this.state.mesh,t=+this.xRotateRef.current.value,a=+this.yRotateRef.current.value,n=+this.zRotateRef.current.value,r=+this.aRotateRef.current.value;e&&e.rotate(new b.j(t,a,n),r*Math.PI)}.bind(this),c=function(){var e=this.state.mesh,t=this.state.scene,a=this.colorRef.current.value;e&&(e.material=new b.h("color",t),e.material.diffuseColor=b.a.FromHexString(a))}.bind(this),s=function(){var e=this.state.mesh,t=+this.alphaRef.current.value;e&&(e.material.alpha=t)}.bind(this),l=function(){this.props.setModelEditing(null),this.props.setEditing(!1)}.bind(this),o=function(){var e=this.state.scene;f.a.GLBAsync(e,"model").then((function(e){e.downloadFiles()}))}.bind(this),i=function(){var t=this.state.scene,a=this.props.modelEditing;f.a.GLBAsync(t,"model").then((function(t){var n=new FormData;n.append("model",t.glTFFiles["model.glb"]),!a||a.public?e("https://ancient-journey-05279.herokuapp.com/models","POST",n):e("https://ancient-journey-05279.herokuapp.com/models/".concat(a.filename),"PUT",n)}))}.bind(this),m=function(e){g(this.state.scene.meshes.find((function(t){return t.id===e.target.id})),this.state.highlight,this.canvasRef.current)}.bind(this);return r.a.createElement(r.a.Fragment,null,!this.state.uploaded&&r.a.createElement("h2",{className:"text-secondary text-center",id:"drag-guide"},"Drag and Drop to Upload Model"),r.a.createElement("canvas",{ref:this.canvasRef}),r.a.createElement("div",{id:"edit",className:"p-3"},!this.state.mesh||r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"input-group mb-3"},r.a.createElement("div",{className:"input-group-append"},r.a.createElement("button",{onClick:t,className:"btn btn-outline-secondary",type:"button"},"Move"),r.a.createElement("span",{className:"input-group-text bg-transparent"},"X")),r.a.createElement("input",{type:"number",ref:this.xMoveRef,step:"0.01",className:"text-white form-control bg-transparent"}),r.a.createElement("div",{className:"input-group-append"},r.a.createElement("span",{className:"input-group-text bg-transparent"},"Y")),r.a.createElement("input",{type:"number",ref:this.yMoveRef,step:"0.01",className:"text-white form-control bg-transparent"}),r.a.createElement("div",{className:"input-group-append"},r.a.createElement("span",{className:"input-group-text bg-transparent"},"Z")),r.a.createElement("input",{type:"number",ref:this.zMoveRef,step:"0.01",className:"text-white form-control bg-transparent"})),r.a.createElement("div",{className:"input-group mb-3"},r.a.createElement("div",{className:"input-group-append"},r.a.createElement("button",{onClick:a,className:"btn btn-outline-secondary",type:"button"},"Scale"),r.a.createElement("span",{className:"input-group-text bg-transparent"},"X")),r.a.createElement("input",{type:"number",ref:this.xScaleRef,step:"0.01",className:"text-white form-control bg-transparent"}),r.a.createElement("div",{className:"input-group-append"},r.a.createElement("span",{className:"input-group-text bg-transparent"},"Y")),r.a.createElement("input",{type:"number",ref:this.yScaleRef,step:"0.01",className:"text-white form-control bg-transparent"}),r.a.createElement("div",{className:"input-group-append"},r.a.createElement("span",{className:"input-group-text bg-transparent"},"Z")),r.a.createElement("input",{type:"number",ref:this.zScaleRef,step:"0.01",className:"text-white form-control bg-transparent"})),r.a.createElement("div",{className:"input-group mb-3"},r.a.createElement("div",{className:"input-group-append"},r.a.createElement("button",{onClick:n,className:"btn btn-outline-secondary",type:"button"},"Rotate"),r.a.createElement("span",{className:"input-group-text bg-transparent"},"X")),r.a.createElement("input",{type:"number",ref:this.xRotateRef,step:"0.01",className:"text-white form-control bg-transparent"}),r.a.createElement("div",{className:"input-group-append"},r.a.createElement("span",{className:"input-group-text bg-transparent"},"Y")),r.a.createElement("input",{type:"number",ref:this.yRotateRef,step:"0.01",className:"text-white form-control bg-transparent"}),r.a.createElement("div",{className:"input-group-append"},r.a.createElement("span",{className:"input-group-text bg-transparent"},"Z")),r.a.createElement("input",{type:"number",ref:this.zRotateRef,step:"0.01",className:"text-white form-control bg-transparent"}),r.a.createElement("div",{className:"input-group-append"},r.a.createElement("span",{className:"input-group-text bg-transparent"},"\u03c0")),r.a.createElement("input",{type:"number",ref:this.aRotateRef,step:"0.01",className:"text-white form-control bg-transparent"})),r.a.createElement("div",{className:"input-group mb-3"},r.a.createElement("div",{className:"input-group-append"},r.a.createElement("button",{onClick:c,className:"btn btn-outline-secondary",type:"button"},"Change Color")),r.a.createElement("input",{type:"color",ref:this.colorRef,className:"form-control bg-transparent",placeholder:"1"})),r.a.createElement("div",{className:"input-group mb-3"},r.a.createElement("div",{className:"input-group-append"},r.a.createElement("button",{onClick:s,className:"btn btn-outline-secondary",type:"button"},"Change Alpha")),r.a.createElement("input",{type:"number",ref:this.alphaRef,steyp:"0.01",min:"0",max:"1",className:"text-white form-control bg-transparent"}))),r.a.createElement("button",{onClick:l,className:"btn btn-outline-secondary mr-3"},"Cancel"),this.state.uploaded&&r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{onClick:o,className:"btn btn-outline-secondary mr-3"},"Download"),r.a.createElement("button",{onClick:i,className:"btn btn-outline-secondary"},"Save"))),this.state.scene&&r.a.createElement("div",{id:"explorer",className:"bg-transparent text-secondary overflow-auto border border-secondary rounded m-3"},this.state.scene.meshes.filter((function(e){return e.metadata})).map((function(e){return r.a.createElement("button",{onClick:m,key:e.id,id:e.id,className:"btn btn-block text-secondary"},e.name)}))))}}]),a}(n.Component);function v(){return r.a.createElement("footer",{className:"fixed-bottom bg-transparent text-light text-center"},r.a.createElement("div",{className:"text-secondary"},"Copyright\xa9 2020 by ",r.a.createElement("a",{href:"https://github.com/Divinil001",className:"text-info"},"Divinil001"),", ",r.a.createElement("a",{href:"https://github.com/tracy2811",className:"text-info"},"tracy2811"),", ",r.a.createElement("a",{href:"https://github.com/nmaria03",className:"text-info"},"nmaria03")))}function N(e){var t=e.token,a=e.models,n=e.getModels,c=e.setEditing,s=e.setModelEditing,l=function(e){c(!0),s({filename:e.target.id,public:!0})},o=function(e){c(!0),s({filename:e.target.id,public:!1})},i=function(e){var a="https://ancient-journey-05279.herokuapp.com/models/".concat(e.target.id);fetch(a,{method:"DELETE",headers:{Authorization:"bearer ".concat(t)}}).then((function(e){e.ok&&n()}))};return r.a.createElement(r.a.Fragment,null,!a||a.public.map((function(e){return r.a.createElement("div",{className:"col-sm-6 col-md-4 col-xl-3",key:e._id},r.a.createElement("div",{className:"card bg-transparent text-white shadow-lg"},r.a.createElement("div",{className:"card-body"},r.a.createElement("h3",{className:"card-title"},e.filename),r.a.createElement("p",{className:"card-text"},"This is a public model."),r.a.createElement("button",{className:"btn btn-block btn-outline-info",id:e.filename,onClick:l},"Edit"))))})),!a||!a.private||a.private.map((function(e){return r.a.createElement("div",{className:"col-sm-6 col-md-4 col-xl-3",key:e._id},r.a.createElement("div",{className:"card bg-transparent text-white shadow-lg"},r.a.createElement("div",{className:"card-body"},r.a.createElement("h3",{className:"card-title"},e.filename),r.a.createElement("p",{className:"card-text"},"This is your private model."),r.a.createElement("button",{className:"btn btn-block btn-outline-danger",id:e.filename,onClick:i},"Delete"),r.a.createElement("button",{className:"btn btn-block btn-outline-info",id:e.filename,onClick:o},"Edit"))))})),r.a.createElement("div",{className:"col-sm-6 col-md-4 col-xl-3"},r.a.createElement("div",{className:"card bg-transparent text-white shadow-lg"},r.a.createElement("div",{className:"card-body"},r.a.createElement("h3",{className:"card-title"},"Editor"),r.a.createElement("p",{className:"card-text"},"Upload your own model and start editing."),r.a.createElement("button",{className:"btn btn-block btn-info",onClick:function(){c(!0),s(null)}},"Go")))))}a(222),a(223);var R=function(){var e=Object(n.useState)(null),t=Object(l.a)(e,2),a=t[0],c=t[1],s=Object(n.useState)(""),m=Object(l.a)(s,2),u=m[0],p=m[1],d=Object(n.useState)(null),h=Object(l.a)(d,2),b=h[0],f=h[1],g=Object(n.useState)(!1),R=Object(l.a)(g,2),y=R[0],x=R[1],k=Object(n.useState)(null),w=Object(l.a)(k,2),j=w[0],O=w[1],C=function(){if(!y&&u){fetch("https://ancient-journey-05279.herokuapp.com/models",{headers:{Authorization:"bearer ".concat(u)}}).then((function(e){return e.json()})).then((function(e){return f(e)}))}};return Object(n.useEffect)(C,[u,y]),r.a.createElement(r.a.Fragment,null,r.a.createElement(i,{user:a,setUser:c,setToken:p}),r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"row p-5 align-content-center justify-content-center"},!a&&r.a.createElement(o,{setToken:p,setUser:c}),!!u&&!y&&r.a.createElement(N,{token:u,models:b,getModels:C,setEditing:x,setModelEditing:O}),!u||!y||r.a.createElement(E,{token:u,setEditing:x,modelEditing:j,setModelEditing:O}))),r.a.createElement(v,null))};s.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(R,null)),document.getElementById("root"))}},[[217,1,2]]]);
//# sourceMappingURL=main.6b0a4aea.chunk.js.map